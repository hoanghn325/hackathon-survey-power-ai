<form class="form-survey" [formGroup]="form">
  <div class="survey-section">
    <h3>NPS Advanced Analysis</h3>

    <button [disabled]="isLoading" (click)="csvImport.click()" id="upload-csv-btn" nzType="primary" nz-button>
      {{ 'Import File' }}
    </button>
    <input #csvImport (change)="handleImportCSV($event)" [accept]="'.csv'" hidden="true" type="file" />
    <div class="action">
      <button [disabled]="isLoading" nz-button nzType="default" (click)="showSurvey()">Process</button>
      <nz-spin *ngIf="isLoading" nzSimple [nzSize]="'small'"></nz-spin>
    </div>
    <ng-container *ngIf="importedData?.length" class="table-data">
      <nz-table [nzLoading]="isLoadingTable" nzTemplateMode [nzData]="importedData" [nzShowPagination]="false"
        [nzBordered]="true">
        <thead>
          <tr>
            <ng-container *ngFor="let column of columns">
              <th [nzColumnKey]="column.key" [nzWidth]="column.width">{{ column.title }}
              </th>
            </ng-container>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of importedData;">
            <td>{{ item.id }}</td>
            <td>{{ item.score }}</td>
            <td>{{ item.text }}</td>
            <td>{{ item.responseDate }}</td>
            <td>{{ item.country }}</td>
            <td>{{ item.userRole }}</td>
            <td>{{ item.organization }}</td>
            <td>{{ item.source }}</td>
            <td>{{ item.plan }}</td>
            <td>{{ item.ecosystem }}</td>
            <td>{{ item.coreChannel }}</td>
            <td>{{ item.coreEndUserAgeAmount }}</td>
            <td>
              <!-- For Theme -->
              <nz-select [(ngModel)]="item.theme" [ngModelOptions]="{standalone: true}"
                (ngModelChange)="themChanged($event, item.theme)" class="theme-dropdown">
                <nz-option *ngFor="let item of themeOptions" [nzValue]="item.id" [nzLabel]="item.text"></nz-option>
              </nz-select>
            </td>
          </tr>
        </tbody>
      </nz-table>
    </ng-container>
    <div class="section-question" *ngIf="result">
      <div class="more-question">
        <div>{{ 'Please input if you have more concern? ' }}</div>
        <input [formControl]="questionFormControl" class="query" nz-input type="text" placeholder="More questions" />
      </div>
      <div class="result">
        {{ result }}
      </div>
    </div>
  </div>
</form>